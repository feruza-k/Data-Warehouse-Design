-- Creating staging area with the autogenerated surrogate key by applying the sequence and trigger

CREATE TABLE stage_table(
STAGE_ID NUMBER NOT NULL,  
LINK_ID VARCHAR2(100), 
LOCATION_LINK VARCHAR2(100), 
LOCATION_NOTATION VARCHAR2(20) NOT NULL, 
LOCATION_LABEL VARCHAR2(70), 
DATE_TIME TIMESTAMP NOT NULL,  
DETERM_LABEL VARCHAR2(20) NOT NULL,  
DETERM_DEFINITION VARCHAR2(100), 
DETERM_NOTATION NUMBER NOT NULL,  
RESULT_QUALIFIER VARCHAR2(10), 
RESULT NUMBER NOT NULL,  
DETERM_UNIT_LABEL VARCHAR2(20) NOT NULL, 
MATERIAL_TYPE VARCHAR2(70) NOT NULL,  
COMPLIANCE VARCHAR2(5) NOT NULL,  
PURPOSE VARCHAR2(100) NOT NULL,  
EASTING NUMBER(6) NOT NULL,  
NORTHING NUMBER(6) NOT NULL
); 


CREATE SEQUENCE trg_key
START WITH 1
INCREMENT BY 1
NOCACHE
NOCYCLE;

CREATE OR REPLACE TRIGGER sequence_key
BEFORE INSERT ON stage_table
FOR EACH ROW 
BEGIN 
SELECT trg_key.NEXTVAL INTO :NEW.STAGE_ID FROM DUAL;
END;